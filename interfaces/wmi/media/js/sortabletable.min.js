/*----------------------------------------------------------------------------\
|                            Sortable Table 1.12                              |
|-----------------------------------------------------------------------------|
|                         Created by Erik Arvidsson                           |
|                  (http://webfx.eae.net/contact.html#erik)                   |
|                      For WebFX (http://webfx.eae.net/)                      |
|-----------------------------------------------------------------------------|
| A DOM 1 based script that allows an ordinary HTML table to be sortable.     |
|-----------------------------------------------------------------------------|
|                  Copyright (c) 1998 - 2006 Erik Arvidsson                   |
|-----------------------------------------------------------------------------|
| Licensed under the Apache License, Version 2.0 (the "License"); you may not |
| use this file except in compliance with the License.  You may obtain a copy |
| of the License at http://www.apache.org/licenses/LICENSE-2.0                |
| - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - |
| Unless  required  by  applicable law or  agreed  to  in  writing,  software |
| distributed under the License is distributed on an  "AS IS" BASIS,  WITHOUT |
| WARRANTIES OR  CONDITIONS OF ANY KIND,  either express or implied.  See the |
| License  for the  specific language  governing permissions  and limitations |
| under the License.                                                          |
|-----------------------------------------------------------------------------|
| 2003-01-10 | First version                                                  |
| 2003-01-19 | Minor changes to the date parsing                              |
| 2003-01-28 | JScript 5.0 fixes (no support for 'in' operator)               |
| 2003-02-01 | Sloppy typo like error fixed in getInnerText                   |
| 2003-07-04 | Added workaround for IE cellIndex bug.                         |
| 2003-11-09 | The bDescending argument to sort was not correctly working     |
|            | Using onclick DOM0 event if no support for addEventListener    |
|            | or attachEvent                                                 |
| 2004-01-13 | Adding addSortType and removeSortType which makes it a lot     |
|            | easier to add new, custom sort types.                          |
| 2004-01-27 | Switch to use descending = false as the default sort order.    |
|            | Change defaultDescending to suit your needs.                   |
| 2004-03-14 | Improved sort type None look and feel a bit                    |
| 2004-08-26 | Made the handling of tBody and tHead more flexible. Now you    |
|            | can use another tHead or no tHead, and you can chose some      |
|            | other tBody.                                                   |
| 2006-04-25 | Changed license to Apache Software License 2.0                 |  
|-----------------------------------------------------------------------------|
| Created 2003-01-10 | All changes are in the log above. | Updated 2006-04-25 |
\----------------------------------------------------------------------------*/function SortableTable(a,b){this.sortTypes=b||[],this.sortColumn=null,this.descending=null;var c=this;this._headerOnclick=function(a){},a?(this.setTable(a),this.document=a.ownerDocument||a.document):this.document=document;var d=this.document.defaultView||this.document.parentWindow;this._onunload=function(){c.destroy()},d&&typeof d.attachEvent!="undefined"&&d.attachEvent("onunload",this._onunload)}SortableTable.gecko=navigator.product=="Gecko",SortableTable.msie=/msie/i.test(navigator.userAgent),SortableTable.removeBeforeSort=SortableTable.gecko,SortableTable.prototype.onsort=function(){},SortableTable.prototype.defaultDescending=!1,SortableTable.prototype._sortTypeInfo={},SortableTable.prototype.setTable=function(a){this.tHead&&this.uninitHeader(),this.element=a,this.setTHead(a.tHead),this.setTBody(a.tBodies[0])},SortableTable.prototype.setTHead=function(a){this.tHead&&this.tHead!=a&&this.uninitHeader(),this.tHead=a,this.initHeader(this.sortTypes)},SortableTable.prototype.setTBody=function(a){this.tBody=a},SortableTable.prototype.setSortTypes=function(a){this.tHead&&this.uninitHeader(),this.sortTypes=a||[],this.tHead&&this.initHeader(this.sortTypes)},SortableTable.prototype.initHeader=function(a){if(!this.tHead)return;var b=this.tHead.rows[0].cells,c=this.tHead.ownerDocument||this.tHead.document;this.sortTypes=a||[];var d=b.length,e,f;for(var g=0;g<d;g++)f=b[g],this.sortTypes[g]!=null&&this.sortTypes[g]!="None"?(e=c.createElement("div"),f.appendChild(e),this.sortTypes[g]!=null&&(f._sortType=this.sortTypes[g]),typeof f.addEventListener!="undefined"?f.addEventListener("click",this._headerOnclick,!1):typeof f.attachEvent!="undefined"?f.attachEvent("onclick",this._headerOnclick):f.onclick=this._headerOnclick):(f.setAttribute("_sortType",a[g]),f._sortType="None");this.updateHeaderArrows()},SortableTable.prototype.uninitHeader=function(){if(!this.tHead)return;var a=this.tHead.rows[0].cells,b=a.length,c;for(var d=0;d<b;d++)c=a[d],c._sortType!=null&&c._sortType!="None"&&(c.removeChild(c.lastChild),typeof c.removeEventListener!="undefined"?c.removeEventListener("click",this._headerOnclick,!1):typeof c.detachEvent!="undefined"&&c.detachEvent("onclick",this._headerOnclick),c._sortType=null,c.removeAttribute("_sortType"))},SortableTable.prototype.updateHeaderArrows=function(){if(!this.tHead)return;var a=this.tHead.rows[0].cells,b=a.length,c;for(var d=0;d<b;d++)a[d]._sortType!=null&&a[d]._sortType!="None"&&(c=a[d].lastChild,d==this.sortColumn?c.className="sort-arrow "+(this.descending?"descending":"ascending"):c.className="sort-arrow")},SortableTable.prototype.headerOnclick=function(a){console.log($(a.target)),console.log(a.target);var b=a.target,c=this;loading_animation_func(gettext("Please wait while sorting list")),tim=setTimeout(function(){c.sort(b.cellIndex),remove_loading_animation()},500)},SortableTable.getCellIndex=function(a){var b=a.parentNode.childNodes,c=b.length,d;for(d=0;b[d]!=a&&d<c;d++);return d},SortableTable.prototype.getSortType=function(a){return this.sortTypes[a]||"String"},SortableTable.prototype.sort=function(a,b,c){if(!this.tBody)return;c==null&&(c=this.getSortType(a));if(c=="None")return;b==null?this.sortColumn!=a?this.descending=this.defaultDescending:this.descending=!this.descending:this.descending=b,this.sortColumn=a,typeof this.onbeforesort=="function"&&this.onbeforesort();var d=this.getSortFunction(c,a),e=this.getCache(c,a),f=this.tBody;e.sort(d),this.descending&&e.reverse();if(SortableTable.removeBeforeSort){var g=f.nextSibling,h=f.parentNode;h.removeChild(f)}var i=e.length;for(var j=0;j<i;j++)f.appendChild(e[j].element);SortableTable.removeBeforeSort&&h.insertBefore(f,g),this.updateHeaderArrows(),this.destroyCache(e),typeof this.onsort=="function"&&this.onsort()},SortableTable.prototype.asyncSort=function(a,b,c){var d=this;this._asyncsort=function(){d.sort(a,b,c)},window.setTimeout(this._asyncsort,1)},SortableTable.prototype.getCache=function(a,b){if(!this.tBody)return[];var c=this.tBody.rows,d=c.length,e=new Array(d),f;for(var g=0;g<d;g++)f=c[g],e[g]={value:this.getRowValue(f,a,b),element:f};return e},SortableTable.prototype.destroyCache=function(a){var b=a.length;for(var c=0;c<b;c++)a[c].value=null,a[c].element=null,a[c]=null},SortableTable.prototype.getRowValue=function(a,b,c){if(this._sortTypeInfo[b]&&this._sortTypeInfo[b].getRowValue)return this._sortTypeInfo[b].getRowValue(a,c);var d,e=a.cells[c];return typeof e.innerText!="undefined"?d=e.innerText.toLowerCase():d=SortableTable.getInnerText(e),this.getValueFromString(d,b)},SortableTable.getInnerText=function(a){var b="",c=a.childNodes,d=c.length;for(var e=0;e<d;e++)switch(c[e].nodeType){case 1:b+=SortableTable.getInnerText(c[e]).toLowerCase();break;case 3:b+=c[e].nodeValue.toLowerCase()}return b},SortableTable.prototype.getValueFromString=function(a,b){return this._sortTypeInfo[b]?this._sortTypeInfo[b].getValueFromString(a):a},SortableTable.prototype.getSortFunction=function(a,b){return this._sortTypeInfo[a]?this._sortTypeInfo[a].compare:SortableTable.basicCompare},SortableTable.prototype.destroy=function(){this.uninitHeader();var a=this.document.parentWindow;a&&typeof a.detachEvent!="undefined"&&a.detachEvent("onunload",this._onunload),this._onunload=null,this.element=null,this.tHead=null,this.tBody=null,this.document=null,this._headerOnclick=null,this.sortTypes=null,this._asyncsort=null,this.onsort=null},SortableTable.prototype.addSortType=function(a,b,c,d){this._sortTypeInfo[a]={type:a,getValueFromString:b||SortableTable.idFunction,compare:c||SortableTable.basicCompare,getRowValue:d}},SortableTable.prototype.removeSortType=function(a){delete this._sortTypeInfo[a]},SortableTable.basicCompare=function(b,c){return b.value<c.value?-1:c.value<b.value?1:0},SortableTable.idFunction=function(a){return a},SortableTable.toUpperCase=function(a){return a.toUpperCase()},SortableTable.toDate=function(a){var b=a.split("-"),c=new Date(0);return c.setFullYear(b[0]),c.setDate(b[2]),c.setMonth(b[1]-1),c.valueOf()},SortableTable.prototype.addSortType("Number",Number),SortableTable.prototype.addSortType("CaseInsensitiveString",SortableTable.toUpperCase),SortableTable.prototype.addSortType("Date",SortableTable.toDate),SortableTable.prototype.addSortType("String");