(function(a){a.preLoadImages=function(b,c){var d=[],e,f,g=0;if(typeof b!="undefined")if(a.isArray(b)){f=b.length;for(e=0;e<f;e++)d[e]=new Image,d[e].onload=function(){g++,g==f&&a.isFunction(c)&&c()},d[e].src=b[e]}else d[0]=new Image,d[0].onload=function(){a.isFunction(c)&&c()},d[0].src=b;d=undefined},a.preLoadCSSImages=function(b){var c=[],d,e=[],f=0,g,h=new RegExp("url((.*))","i"),i,j=document.styleSheets,k,l,m,n,o,p,q,r;for(q=0;q<j.length;q++){var s=j[q];typeof s.href=="string"&&s.href.length>0?(i=s.href.split("/"),i.pop(),k=i.join("/")+"/"):k="./",l=s.cssRules?s.cssRules:s.rules;for(r=0;r<l.length;r++){m=l[r],o=m.cssText?m.cssText:m.style.cssText,n=h.exec(o);if(n!=null){p=n[1].substring(1,n[1].indexOf(")",1));if(p.substring(0,4)=="http")e[e.length]=p;else if(n[1].substring(1,2)=="/"){var t=k.split("/");t.pop(),t.pop(),p2x=t.join("/"),e[e.length]=p2x+p}else e[e.length]=k+p}}}g=e.length;for(d=0;d<g;d++)c[d]=new Image,c[d].onload=function(){f++,f==g&&a.isFunction(b)&&b()},c[d].src=e[d]},a.preLoadAllImages=function(b,c){typeof b!="undefined"&&(a.isFunction(b)?c=b:a.isArray(b)||(b=[b])),a.preLoadCSSImages(function(){b.length>0?a.preLoadImages(b,function(){c()}):c()})}})(jQuery);