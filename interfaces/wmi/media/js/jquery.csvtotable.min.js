(function(a){String.prototype.splitCSV=function(a){for(var b=this.split(a=a||","),c=b.length-1,d;c>=0;c--)b[c].replace(/"\s+$/,'"').charAt(b[c].length-1)=='"'?(d=b[c].replace(/^\s+"/,'"')).length>1&&d.charAt(0)=='"'?b[c]=b[c].replace(/^\s*"|"\s*$/g,"").replace(/""/g,'"'):c?b.splice(c-1,2,[b[c-1],b[c]].join(a)):b=b.shift().split(a).concat(b):b[c].replace(/""/g,'"');return b},a.fn.CSVToTable=function(b,c){var d={tableClass:"CSVTable",theadClass:"",thClass:"",tbodyClass:"",trClass:"",tdClass:"",loadingImage:"",loadingText:"Loading CSV data...",separator:";",startLine:0},c=a.extend(d,c);return this.each(function(){var d=a(this),e="";c.loadingImage?loading='<div style="text-align: center"><img alt="'+c.loadingText+'" src="'+c.loadingImage+'" /><br>'+c.loadingText+"</div>":loading=c.loadingText,d.html(loading),data=b;var f='<table class="'+c.tableClass+'">',g=data.replace("\r","").split("\n"),h=0,i=0,j=new Array;a.each(g,function(b,d){b==0&&typeof c.headers!="undefined"&&(j=c.headers,i=j.length,f+='<thead class="'+c.theadClass+'"><tr class="'+c.trClass+'">',a.each(j,function(a,b){f+='<th class="'+c.thClass+'">'+b+"</th>"}),f+='</tr></thead><tbody class="'+c.tbodyClass+'">');if(b==c.startLine&&typeof c.headers=="undefined")j=d.splitCSV(c.separator),i=j.length,f+='<thead class="'+c.theadClass+'"><tr class="'+c.trClass+'">',a.each(j,function(a,b){f+='<th class="'+c.thClass+'">'+b+"</th>"}),f+='</tr></thead><tbody class="'+c.tbodyClass+'">';else if(b>=c.startLine){var g=d.splitCSV(c.separator);g.length>1&&(h++,g.length!=i&&(e+="error on line "+b+": Item count ("+g.length+") does not match header count ("+i+") \n"),h%2?oddOrEven="odd":oddOrEven="even",f+='<tr class="'+c.trClass+" "+oddOrEven+'">',a.each(g,function(a,b){f+='<td class="'+c.tdClass+'">'+b+"</td>"}),f+="</tr>")}}),f+="</tbody></table>",d.fadeOut(500,function(){d.html(f)}).fadeIn(function(){setTimeout(function(){d.trigger("loadComplete")},0)})})}})(jQuery);